(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[203],{43790:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/game",function(){return n(75945)}])},63390:function(t,e,n){"use strict";var i=n(85893),r=(n(67294),n(27680)),o=(0,r.makeStyles)((function(t){return{root:{background:t.palette.background.gradient,flexGrow:1,flexShrink:1,display:"flex",flexDirection:"column",justifyContent:"center"}}}));e.Z=function(t){var e=t.children,n=o();return(0,i.jsx)(r.Box,{className:n.root,children:e})}},75945:function(t,e,n){"use strict";n.r(e),n.d(e,{Metaverse:function(){return k},default:function(){return T}});var i=n(34051),r=n.n(i),o=n(85893),a=n(67294),s=n(77044),c=n(27680),u=n(3283),l=n.n(u),h=n(63390);function d(t,e,n,i,r,o,a){try{var s=t[o](a),c=s.value}catch(u){return void n(u)}s.done?e(c):Promise.resolve(c).then(i,r)}function p(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var o=t.apply(e,n);function a(t){d(o,i,r,a,s,"next",t)}function s(t){d(o,i,r,a,s,"throw",t)}a(void 0)}))}}function f(t,e){return y.apply(this,arguments)}function y(){return(y=p(r().mark((function t(e,i){var o,a,s,c,u,l,h,d,p,f,y,g,m,v,x;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return g=function(){this.load.image("food","assets/games/snake/food.png"),this.load.image("body","assets/games/snake/body.png"),console.log("Game is Preloaded.")},m=function(){console.log("Game is Created.");var t=new Phaser.Class({Extends:Phaser.GameObjects.Image,initialize:function(t,e,n){Phaser.GameObjects.Image.call(this,t),this.setTexture("food"),this.setPosition(8*e,8*n),this.setOrigin(0),this.total=0,t.children.add(this)},eat:function(){this.total++}}),e=new Phaser.Class({initialize:function(t,e,n){this.headPosition=new Phaser.Geom.Point(e,n),this.body=t.add.group(),this.head=this.body.create(8*e,8*n,"body"),this.head.setOrigin(0),this.alive=!0,this.speed=100,this.moveTime=0,this.tail=new Phaser.Geom.Point(e,n),this.heading=p,this.direction=p},update:function(t){if(t>=this.moveTime)return this.move(t)},faceLeft:function(){this.direction!==l&&this.direction!==h||(this.heading=d)},faceRight:function(){this.direction!==l&&this.direction!==h||(this.heading=p)},faceUp:function(){this.direction!==d&&this.direction!==p||(this.heading=l)},faceDown:function(){this.direction!==d&&this.direction!==p||(this.heading=h)},move:function(t){switch(this.heading){case d:this.headPosition.x=Phaser.Math.Wrap(this.headPosition.x-1,0,40);break;case p:this.headPosition.x=Phaser.Math.Wrap(this.headPosition.x+1,0,40);break;case l:this.headPosition.y=Phaser.Math.Wrap(this.headPosition.y-1,0,30);break;case h:this.headPosition.y=Phaser.Math.Wrap(this.headPosition.y+1,0,30)}return this.direction=this.heading,Phaser.Actions.ShiftPosition(this.body.getChildren(),8*this.headPosition.x,8*this.headPosition.y,1,this.tail),Phaser.Actions.GetFirst(this.body.getChildren(),{x:this.head.x,y:this.head.y},1)?(console.log("dead"),this.alive=!1,!1):(this.moveTime=t+this.speed,!0)},grow:function(){this.body.create(this.tail.x,this.tail.y,"body").setOrigin(0)},collideWithFood:function(t){return this.head.x===t.x&&this.head.y===t.y&&(this.grow(),t.eat(),this.speed>20&&t.total%5===0&&(this.speed-=5),!0)},updateGrid:function(t){return this.body.children.each((function(e){var n=e.x/8,i=e.y/8;t[i][n]=!1})),t}});c=new t(this,3,4),s=new e(this,8,8),u=this.input.keyboard.createCursorKeys()},v=function(t,e){if(s.alive){if(y>=1e3)return s.alive=!1,console.log("send callback"),i(c.total),void console.log("end callback");u.left.isDown?s.faceLeft():u.right.isDown?s.faceRight():u.up.isDown?s.faceUp():u.down.isDown&&s.faceDown(),s.update(t)&&s.collideWithFood(c)&&x(),y++}},function(){for(var t=[],e=0;e<30;e++){t[e]=[];for(var n=0;n<40;n++)t[e][n]=!0}s.updateGrid(t);var i=[];for(e=0;e<30;e++)for(n=0;n<40;n++)!0===t[e][n]&&i.push({x:n,y:e});if(i.length>0){var r=Phaser.Math.RND.pick(i);return console.log("pos.x",r.x),console.log("pos.y",r.y),c.setPosition(8*r.x,8*r.y),!0}return!1},x=function(){console.log("footArray",e),console.log("footIndex",f);var t=e[f%e.length];c.setPosition(8*t[0],8*t[1]),f++},t.next=8,n.e(989).then(n.t.bind(n,82260,23));case 8:o=t.sent,a={type:o.WEBGL,width:320,height:240,backgroundColor:"#bfcc00",parent:"game",scene:{preload:g,create:m,update:v}},new o.Game(a);case 11:l=0,h=1,d=2,p=3,f=0,y=0;case 25:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var g=n(68288),m=n(11163);function v(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function x(t,e,n,i,r,o,a){try{var s=t[o](a),c=s.value}catch(u){return void n(u)}s.done?e(c):Promise.resolve(c).then(i,r)}function b(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var o=t.apply(e,n);function a(t){x(o,i,r,a,s,"next",t)}function s(t){x(o,i,r,a,s,"throw",t)}a(void 0)}))}}function w(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o=[],a=!0,s=!1;try{for(n=n.call(t);!(a=(i=n.next()).done)&&(o.push(i.value),!e||o.length!==e);a=!0);}catch(c){s=!0,r=c}finally{try{a||null==n.return||n.return()}finally{if(s)throw r}}return o}}(t,e)||function(t,e){if(!t)return;if("string"===typeof t)return v(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return v(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var P=n(57103),k=function(){a.useEffect((function(){}),[]);var t=(0,s.useWeb3React)(),e=t.account,n=t.library,i=t.chainId,u=((0,m.useRouter)(),w(a.useState(void 0),2)),d=u[0],p=u[1],y=w(a.useState(0),2),v=y[0],x=y[1],k=w(a.useState([]),2),T=k[0],G=k[1],C=w(a.useState(0),2),j=C[0],S=C[1],I=function(){var t=b(r().mark((function t(){var n,i,o,a;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=1,t.next=4,d.methods.play().send({from:e,gasPrice:"0"});case 4:return n=t.sent,console.log("tx:",n),t.next=8,d.methods.getGamesCount().call();case 8:return n=t.sent,console.log("gamesCount:",n),S(n),x(i=n-1),t.next=15,d.methods.getConfig(i).call();case 15:o=t.sent,console.log("config:",o),o=o.map((function(t){return[parseInt(t[0]),parseInt(t[1])]})),console.log("config:",o),a=function(){var t=b(r().mark((function t(n){var o;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("data test:",i),console.log("data params:",n),t.next=4,d.methods.publishScore(i,n).send({from:e,gasPrice:"0"});case 4:o=t.sent,console.log("data test:",o);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),f(o,a),t.next=27;break;case 23:return t.prev=23,t.t0=t.catch(1),console.log("init error",t.t0),t.abrupt("return",null);case 27:case"end":return t.stop()}}),t,null,[[1,23]])})));return function(){return t.apply(this,arguments)}}(),M=function(){var t=b(r().mark((function t(e,n){var i,o,a,s,c,u;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=new(l())(n.provider),o=new i.eth.Contract(P,g.pY),p(o),t.prev=4,t.next=7,o.methods.getGamesCount().call();case 7:a=t.sent,console.log("games:",a),S(a),(s=a)>5&&(s=5),c=[],u=0;case 14:if(!(u<s)){t.next=24;break}return t.next=17,o.methods.games(u).call();case 17:a=t.sent,console.log("game id",u),console.log("game",a),c.push(a);case 21:u++,t.next=14;break;case 24:console.log("tempGames",c),c.length>0?G(c):G([]),t.next=32;break;case 28:return t.prev=28,t.t0=t.catch(4),console.log("init error",t.t0),t.abrupt("return",null);case 32:case"end":return t.stop()}}),t,null,[[4,28]])})));return function(e,n){return t.apply(this,arguments)}}();return a.useEffect((function(){return e&&n&&M(e,n),null}),[e,n,i]),(0,o.jsx)(h.Z,{children:(0,o.jsx)(c.Box,{py:8,bgcolor:"background.default",children:(0,o.jsxs)(c.Container,{maxWidth:"md",children:[(0,o.jsx)(c.Typography,{variant:"h3",sx:{pb:6},children:"Game"}),(0,o.jsx)("div",{id:"game"}),(0,o.jsx)(c.Typography,{variant:"h6",color:"text.secondary",align:"center",children:"Game Info"}),(0,o.jsxs)(c.Typography,{variant:"body2",color:"text.secondary",align:"center",children:["gameId: ",v]}),(0,o.jsx)(c.Typography,{variant:"h6",color:"text.secondary",align:"center",children:"All Games"}),(0,o.jsxs)(c.Typography,{variant:"body2",color:"text.secondary",align:"center",children:["Games played in total: ",j]}),(0,o.jsx)(c.Typography,{variant:"body2",color:"text.secondary",align:"center",children:"Last Games"}),(0,o.jsx)(c.Button,{onClick:I,children:"Play Ranked"}),T.map((function(t,e){return(0,o.jsxs)(c.Typography,{variant:"body2",color:"text.secondary",align:"center",children:["Player 1: ",t.player1,"Player 2: ",t.player2]})}))]})})})},T=k},89214:function(){},71922:function(){},2363:function(){},96419:function(){},56353:function(){},27790:function(){},69386:function(){},31616:function(){},29120:function(){},46586:function(){},6567:function(){},69862:function(){},40964:function(){},57103:function(t){"use strict";t.exports=JSON.parse('[{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"games","outputs":[{"internalType":"address","name":"player1","type":"address"},{"internalType":"address","name":"player2","type":"address"},{"internalType":"uint256","name":"player1Points","type":"uint256"},{"internalType":"uint256","name":"player2Points","type":"uint256"},{"internalType":"address","name":"winner","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"gameId","type":"uint256"}],"name":"getConfig","outputs":[{"internalType":"uint256[2][]","name":"","type":"uint256[2][]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getGamesCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"play","outputs":[{"internalType":"uint256[2][]","name":"","type":"uint256[2][]"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"gameId","type":"uint256"},{"internalType":"uint256","name":"score","type":"uint256"}],"name":"publishScore","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"test","outputs":[{"internalType":"int256","name":"","type":"int256"}],"stateMutability":"view","type":"function"}]')}},function(t){t.O(0,[482,714,100,389,774,888,179],(function(){return e=43790,t(t.s=e);var e}));var e=t.O();_N_E=e}]);