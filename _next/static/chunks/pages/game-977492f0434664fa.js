(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[203],{43790:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/game",function(){return n(75945)}])},75945:function(t,e,n){"use strict";n.r(e),n.d(e,{Metaverse:function(){return w},default:function(){return P}});var i=n(34051),r=n.n(i),a=n(85893),o=n(67294),s=n(77044),c=n(27680),u=n(3283),l=n.n(u);function h(t,e,n,i,r,a,o){try{var s=t[a](o),c=s.value}catch(u){return void n(u)}s.done?e(c):Promise.resolve(c).then(i,r)}function d(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var a=t.apply(e,n);function o(t){h(a,i,r,o,s,"next",t)}function s(t){h(a,i,r,o,s,"throw",t)}o(void 0)}))}}function p(t,e){return f.apply(this,arguments)}function f(){return(f=d(r().mark((function t(e,i){var a,o,s,c,u,l,h,d,p,f,y,g,m,v,b;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return g=function(){this.load.image("food","assets/games/snake/food.png"),this.load.image("body","assets/games/snake/body.png"),console.log("Game is Preloaded.")},m=function(){console.log("Game is Created.");var t=new Phaser.Class({Extends:Phaser.GameObjects.Image,initialize:function(t,e,n){Phaser.GameObjects.Image.call(this,t),this.setTexture("food"),this.setPosition(8*e,8*n),this.setOrigin(0),this.total=0,t.children.add(this)},eat:function(){this.total++}}),e=new Phaser.Class({initialize:function(t,e,n){this.headPosition=new Phaser.Geom.Point(e,n),this.body=t.add.group(),this.head=this.body.create(8*e,8*n,"body"),this.head.setOrigin(0),this.alive=!0,this.speed=100,this.moveTime=0,this.tail=new Phaser.Geom.Point(e,n),this.heading=p,this.direction=p},update:function(t){if(t>=this.moveTime)return this.move(t)},faceLeft:function(){this.direction!==l&&this.direction!==h||(this.heading=d)},faceRight:function(){this.direction!==l&&this.direction!==h||(this.heading=p)},faceUp:function(){this.direction!==d&&this.direction!==p||(this.heading=l)},faceDown:function(){this.direction!==d&&this.direction!==p||(this.heading=h)},move:function(t){switch(this.heading){case d:this.headPosition.x=Phaser.Math.Wrap(this.headPosition.x-1,0,40);break;case p:this.headPosition.x=Phaser.Math.Wrap(this.headPosition.x+1,0,40);break;case l:this.headPosition.y=Phaser.Math.Wrap(this.headPosition.y-1,0,30);break;case h:this.headPosition.y=Phaser.Math.Wrap(this.headPosition.y+1,0,30)}return this.direction=this.heading,Phaser.Actions.ShiftPosition(this.body.getChildren(),8*this.headPosition.x,8*this.headPosition.y,1,this.tail),Phaser.Actions.GetFirst(this.body.getChildren(),{x:this.head.x,y:this.head.y},1)?(console.log("dead"),this.alive=!1,!1):(this.moveTime=t+this.speed,!0)},grow:function(){this.body.create(this.tail.x,this.tail.y,"body").setOrigin(0)},collideWithFood:function(t){return this.head.x===t.x&&this.head.y===t.y&&(this.grow(),t.eat(),this.speed>20&&t.total%5===0&&(this.speed-=5),!0)},updateGrid:function(t){return this.body.children.each((function(e){var n=e.x/8,i=e.y/8;t[i][n]=!1})),t}});c=new t(this,3,4),s=new e(this,8,8),u=this.input.keyboard.createCursorKeys()},v=function(t,e){if(s.alive){if(y>=1e3)return s.alive=!1,console.log("send callback"),i(c.total),void console.log("end callback");u.left.isDown?s.faceLeft():u.right.isDown?s.faceRight():u.up.isDown?s.faceUp():u.down.isDown&&s.faceDown(),s.update(t)&&s.collideWithFood(c)&&b(),y++}},function(){for(var t=[],e=0;e<30;e++){t[e]=[];for(var n=0;n<40;n++)t[e][n]=!0}s.updateGrid(t);var i=[];for(e=0;e<30;e++)for(n=0;n<40;n++)!0===t[e][n]&&i.push({x:n,y:e});if(i.length>0){var r=Phaser.Math.RND.pick(i);return console.log("pos.x",r.x),console.log("pos.y",r.y),c.setPosition(8*r.x,8*r.y),!0}return!1},b=function(){console.log("footArray",e),console.log("footIndex",f);var t=e[f%e.length];c.setPosition(8*t[0],8*t[1]),f++},t.next=8,n.e(989).then(n.t.bind(n,82260,23));case 8:a=t.sent,o={type:a.WEBGL,width:320,height:240,backgroundColor:"#bfcc00",parent:"game",scene:{preload:g,create:m,update:v}},new a.Game(o);case 11:l=0,h=1,d=2,p=3,f=0,y=0;case 25:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var y=n(68288);function g(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function m(t,e,n,i,r,a,o){try{var s=t[a](o),c=s.value}catch(u){return void n(u)}s.done?e(c):Promise.resolve(c).then(i,r)}function v(t){return function(){var e=this,n=arguments;return new Promise((function(i,r){var a=t.apply(e,n);function o(t){m(a,i,r,o,s,"next",t)}function s(t){m(a,i,r,o,s,"throw",t)}o(void 0)}))}}function b(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,a=[],o=!0,s=!1;try{for(n=n.call(t);!(o=(i=n.next()).done)&&(a.push(i.value),!e||a.length!==e);o=!0);}catch(c){s=!0,r=c}finally{try{o||null==n.return||n.return()}finally{if(s)throw r}}return a}}(t,e)||function(t,e){if(!t)return;if("string"===typeof t)return g(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var x=n(57103),w=function(){var t=(0,s.useWeb3React)(),e=t.account,n=t.library,i=t.chainId,u=b(o.useState(void 0),2),h=u[0],d=u[1],f=b(o.useState(0),2),g=f[0],m=f[1],w=b(o.useState([]),2),P=w[0],T=w[1],k=b(o.useState(0),2),G=k[0],C=k[1],j=function(){var t=v(r().mark((function t(){var n,i,a,o;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=1,t.next=4,h.methods.play().send({from:e,gasPrice:"0"});case 4:return n=t.sent,console.log("tx:",n),t.next=8,h.methods.getGamesCount().call();case 8:return n=t.sent,console.log("gamesCount:",n),C(n),m(i=n-1),t.next=15,h.methods.getConfig(i).call();case 15:return a=t.sent,console.log("config:",a),a=a.map((function(t){return[parseInt(t[0]),parseInt(t[1])]})),console.log("config:",a),o=function(){var t=v(r().mark((function t(n){var a;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("data test:",i),console.log("data params:",n),t.next=4,h.methods.publishScore(i,n).send({from:e,gasPrice:"0"});case 4:a=t.sent,console.log("data test:",a);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),p(a,o),t.abrupt("return",!0);case 24:return t.prev=24,t.t0=t.catch(1),console.log("init error",t.t0),t.abrupt("return",null);case 28:case"end":return t.stop()}}),t,null,[[1,24]])})));return function(){return t.apply(this,arguments)}}(),S=function(){var t=v(r().mark((function t(e,n){var i,a,o,s,c,u;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=new(l())(n.provider),a=new i.eth.Contract(x,y.pY),d(a),t.prev=4,t.next=7,a.methods.getGamesCount().call();case 7:o=t.sent,console.log("games:",o),C(o),(s=o)>5&&(s=5),c=[],u=0;case 14:if(!(u<s)){t.next=24;break}return t.next=17,a.methods.games(u).call();case 17:o=t.sent,console.log("game id",u),console.log("game",o),c.push(o);case 21:u++,t.next=14;break;case 24:console.log("tempGames",c),c.length>0?T(c):T([]),t.next=32;break;case 28:return t.prev=28,t.t0=t.catch(4),console.log("init error",t.t0),t.abrupt("return",null);case 32:case"end":return t.stop()}}),t,null,[[4,28]])})));return function(e,n){return t.apply(this,arguments)}}();return o.useEffect((function(){return e&&n&&S(e,n),null}),[e,n,i]),(0,a.jsx)(c.BaseLayout,{children:(0,a.jsx)(c.Section,{children:(0,a.jsxs)(c.Container,{maxWidth:"md",children:[(0,a.jsx)(c.Typography,{variant:"h3",sx:{pb:6},children:"Game"}),(0,a.jsx)("div",{id:"game"}),(0,a.jsx)(c.Typography,{variant:"h6",color:"text.secondary",align:"center",children:"Game Info"}),(0,a.jsxs)(c.Typography,{variant:"body2",color:"text.secondary",align:"center",children:["gameId: ",g]}),(0,a.jsx)(c.Typography,{variant:"h6",color:"text.secondary",align:"center",children:"All Games"}),(0,a.jsxs)(c.Typography,{variant:"body2",color:"text.secondary",align:"center",children:["Games played in total: ",G]}),(0,a.jsx)(c.Typography,{variant:"body2",color:"text.secondary",align:"center",children:"Last Games"}),(0,a.jsx)(c.Button,{onClick:j,children:"Play Ranked"}),P.map((function(t,e){return(0,a.jsxs)(c.Typography,{variant:"body2",color:"text.secondary",align:"center",children:["Player 1: ",t.player1,"Player 2: ",t.player2]})}))]})})})},P=w},89214:function(){},71922:function(){},2363:function(){},96419:function(){},56353:function(){},27790:function(){},69386:function(){},31616:function(){},29120:function(){},46586:function(){},6567:function(){},69862:function(){},40964:function(){},57103:function(t){"use strict";t.exports=JSON.parse('[{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"games","outputs":[{"internalType":"address","name":"player1","type":"address"},{"internalType":"address","name":"player2","type":"address"},{"internalType":"uint256","name":"player1Points","type":"uint256"},{"internalType":"uint256","name":"player2Points","type":"uint256"},{"internalType":"address","name":"winner","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"gameId","type":"uint256"}],"name":"getConfig","outputs":[{"internalType":"uint256[2][]","name":"","type":"uint256[2][]"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"getGamesCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"play","outputs":[{"internalType":"uint256[2][]","name":"","type":"uint256[2][]"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"gameId","type":"uint256"},{"internalType":"uint256","name":"score","type":"uint256"}],"name":"publishScore","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"test","outputs":[{"internalType":"int256","name":"","type":"int256"}],"stateMutability":"view","type":"function"}]')}},function(t){t.O(0,[482,714,100,389,774,888,179],(function(){return e=43790,t(t.s=e);var e}));var e=t.O();_N_E=e}]);